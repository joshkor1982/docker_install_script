#!/bin/bash
#---------------------------------------------------------------------------------------
#	Docker Quick Install and Hello World Test (Created by Joshua Millett)
#---------------------------------------------------------------------------------------

main_menu()

{
		
#COLOR SHELL VARIABLES

red=$(tput setaf 1)
grn=$(tput setaf 2)
reset=$(tput sgr0)

# MENU OPTIONS
while :
do
clear

echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>>>>>>  ${red}PRESS Y TO INSTALL${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================${reset}"
echo "${grn}================================================================================"${reset}
echo "[1] Install Docker"
echo "[0] Exit"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo "Select an option to continue ${red}[1-5]${reset}: "

# MENU COMMANDS

read main_menu
case "$main_menu" in

#-------------------------------------------------------------------------------------
# MENU OPTION 1
#-------------------------------------------------------------------------------------
"1")
while true; do
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>>>>>>  ${red}PRESS Y TO INSTALL${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================"
echo "${grn}================================================================================"${reset}
echo " [${grn}O${reset}] ${red}apt-transport-https${reset}"
echo " [${grn}O${reset}] ${red}ca-certificates${reset}"
echo " [${grn}O${reset}] ${red}curl${reset}"
echo " [${grn}O${reset}] ${red}software-properties-common${reset}"
echo " [${grn}O${reset}] ${red}apt-key fingerprint 0EBFCD88${reset}"
echo " [${grn}O${reset}] ${red}repository file (stable)${reset}"
echo " [${grn}O${reset}] ${red}docker-ce${reset}"
echo " [${grn}O${reset}] ${red}docker-cli${reset}"
echo " [${grn}O${reset}] ${red}containerd.io${reset}"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
read -p "Press (Y) to install Docker and its dependencies, or press (N) to quit: " yn
case $yn in
[Yy]*) 
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>>>>>>>  ${red}REMOVING DOCKER${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================"
echo "${grn}================================================================================"${reset}
sudo apt-get remove docker docker-engine docker.io containerd runc
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  ${red}UPDATING${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
sudo apt-get update
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>>>>>  ${red}INSTALLING PACKAGES${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>>>>> ${red}ADDING DOCKER'S GPG KEY${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}    
    sudo curl -f -s https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>>>  ${red}VERIFYING KEY+FINGERPRINT${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
    sudo apt-key fingerprint 0EBFCD88
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>>>  ${red}ADDING DOCKER REPOSITORY${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
    sudo add-apt-repository \
    "deb [arch=amd64] https://download.docker.com/linux/ubuntu \
    $(lsb_release -cs) \
    stable"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>>>>>  ${red}INSTALLING DOCKER${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
    sudo apt-get install docker-ce
    sudo apt-get install docker-ce-cli
    sudo apt-get install containerd.io
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>  ${red}RUNNING DOCKER HELLO WORLD!${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
    sudo docker run hello-world
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}
echo ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>  ${red}COMPLETE!!!!${reset}  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"
echo "${grn}================================================================================"${reset}
echo "${grn}================================================================================"${reset}

read -n 1 -p "${grn}Docker is now installed! Press Enter to continue: ${reset}"
main_menu;
break;;
[Nn]*) main_menu;;
*) echo "Invalid Selection! Press Enter to try again.."
esac
done
main_menu
;;
"0") exit 0;;
# MAKE A CORRECT SELECTION
    *) echo "Invalid Selection! Press Enter to try again.."
echo "Press ENTER to continue...";
read
;;
esac
done
}
# RETURN TO MAIN MENU
main_menu



